!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Schema=e()}}(function(){return function e(t,r,n){function a(i,u){if(!r[i]){if(!t[i]){var c="function"==typeof require&&require;if(!u&&c)return c(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var f=r[i]={exports:{}};t[i][0].call(f.exports,function(e){var r=t[i][1][e];return a(r?r:e)},f,f.exports,e,t,r,n)}return r[i].exports}for(var o="function"==typeof require&&require,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./utils"),a=[],o=function(){a=[]};r.clean=o;var i=function(e,t){a[e]=t},u=function(e){return a[e]},c=function(e,t){return(0,n.getElementPath)(e)+e.children.length},l=function(e,t){var r=void 0;r=Array.isArray(t)?[]:{};for(var a in t)r[a]=(0,n.getDataFromVar)(e,t[a]);return r},f=function(e,t){var r=Object.create(e);if(e.data){r.data=JSON.parse(JSON.stringify(e.data));for(var n in t)r.data[n]=t[n]}return r},d=function(e){return"object"==typeof e};r.isComponent=d;var s=function(e,t,r){var a=c(e.parent),o=u(a);if(o)return o;var d=t[0],s=l(r,t[1]),v=(0,n.getContent)(t),p=f(d,s);return p.content=v,i(a,p),p};r.buildComponent=s},{"./utils":11}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=(e("./exr"),e("./utils")),a=e("./component"),o=e("./element"),i=e("./renderer"),u=function(e,t,r){var a=(0,n.getTag)(r),u=(0,n.getContent)(r,e);t.el=(0,o.newDomElement)(t.parent,a),t.el.innerHTML=(0,n.validateContent)(u),t.parent=t.el,(0,i.traverse)(e,t,r),t.parent=t.parent.parentNode},c=function(e,t,r){var c=(0,n.getTag)(r);if((0,a.isComponent)(c)){var l=(0,o.newDomElement)(t.parent,"div"),f=(0,a.buildComponent)(t,r,e);(0,i.render)(f,l);for(var d=1;d<r.length;d++)(0,n.applySelector)(l,r[d])}else u(e,t,r)};r.renderElementArray=c},{"./component":1,"./element":4,"./exr":6,"./renderer":9,"./utils":11}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./utils"),a=e("./exr"),o=e("./core"),i=[{regex:(0,a.GET)("ATTR"),method:function(e,t,r){var a=(0,n.getAttribute)(e,r);t.el.setAttribute(a.attr,a.value)}},{regex:(0,a.GET)("DATA"),method:function(e,t,r){var a=(0,n.getDataFromVar)(e,r);(0,n.applySelector)(t.el,a)||(t.el.innerHTML=a)}},{regex:(0,a.GET)("EVENT"),method:function(e,t,r){var a=r.replace("!","").replace(/\s/,"").split(":"),o=a[0],i=a[1],u=i.match(/\([\$a-z,A-Z.]+\)/);if(i=i.replace(/\([\$a-z,A-Z.]+\)/,""),u){u=u[0].replace(/\(|\)/g,"").split(",");for(var c in u)u[c]=(0,n.getDataFromVar)(e,u[c])}o.match(/[0-9]/)?t.el.addEventListener("keypress",function(t){var r=t.which||t.keyCode;if(r==o){var n=[e,t];n=n.concat(u),e[i].apply(void 0,n)}}):t.el[o]=function(t){var r=[e,t];r=r.concat(u),e[i].apply(void 0,r)}}},{regex:/^[a-z,A-Z]+\(\)/,method:function(e,t,r){t.el[r.replace(/\(\)/,"")]()}},{regex:(0,a.GET)("IF"),method:function(e,t,r){var n=r.replace(/^\?\s+/,"");if((0,a.CHECK)(n,"DATA")){var o=e.data[(0,a.REPLACE)(n,"DATA","")];o||(t.el.style.display="none")}}},{regex:(0,a.GET)("FOR"),method:function(e,t,r,i){var u=r.replace((0,a.GET)("FOR"),"").split(/\s+\in\s+/),c=e.data[u[1].replace((0,a.GET)("DATA"),"")],l=u[0].replace((0,a.GET)("DATA"),"");for(var f in c)e.data[l]=c[f],e.data.$=f,(0,o.renderElementArray)(e,t,(0,n.getContent)(i));return!0}}],u=function(e,t,r,n){var a=!1;return i.forEach(function(o){if(e.match(o.regex)){var i=o.method(r,t,e,n);i&&(a=!0)}}),a};r.driveDirectives=u},{"./core":2,"./exr":6,"./utils":11}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./exr"),a=e("./utils"),o=function(e,t){var r=t||"span";if((0,n.CHECK)(r,"ID")||(0,n.CHECK)(r,"CLAS")){var o=document.createElement("div");(0,a.applySelector)(o,r)}else var o=document.createElement(r);return e.appendChild(o),o};r.newDomElement=o},{"./exr":6,"./utils":11}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./renderer"),a=e("./component"),o=e("./model"),i=document.createElement("div");i.id="--rendered-styles",document.body.appendChild(i);var u={};u.engine=n.render,u.clean=a.clean,u.model=o.model,r["default"]=u,t.exports=r["default"]},{"./component":1,"./model":8,"./renderer":9}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={ATTR:/^[a-z,A-Z,-]+\:\s/,ID:/^\#/,CLAS:/(^|\s+)\./g,DATA:/^\$/,EVENT:/^\!/,TRANS:/^\>/,IF:/^\?\s+/,FOR:/^\%\s+/,WRAP:/^\[[a-z,A-Z,0-9,-]+\]/},a=function(e,t){return e.match(n[t])};r.CHECK=a;var o=function(e,t,r){return e.replace(n[t],r)};r.REPLACE=o;var i=function(e){return n[e]};r.GET=i},{}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./utils"),a={"==":function(e,t){var r=e.map(function(e){return(0,n.getDataFromVar)(t,e)});return r[1]==r[2]?r[3]:r.length>4?r[4]:void 0}},o=function(e,t){var r=t[0];return a[r]?a[r](t,e):t};r.driveFilters=o},{"./utils":11}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./renderer"),a=[],o=[],i=[],u=function(e,t){t.data=null,t.name=e,t.listeners=[],a[e]=t;for(var r in t)o[r]||(o[r]=[]),"init"==r&&"save"==r&&"load"==r||o[r].push(t);t.init&&(t.data=t.init(t.data))};r.model=u;var c=function(e,t){return a[e].listeners.push(t),a[e].data};r.attach=c;var l=function(e){o[e.type].forEach(function(t){var r=t[e.type](t.data,e,t);t.data=r,i.push(r),t.listeners&&t.listeners.forEach(function(e){e.models[t.name](t.data),(0,n.render)(e,e.root)})})};r.dispatch=l},{"./renderer":9}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./directives"),a=e("./filters"),o=e("./styles"),i=e("./core"),u=e("./utils"),c=e("./exr"),l=e("./model"),f=function s(e,t){t.innerHTML="",e.root=t,e.key||(e.key=(0,u.generateKey)(8)),e.root.className=e.key;var r={parent:t,el:null};if(e.setData=function(t){for(var r in t)e.data[r]=t[r];s(e,e.root)},e.setStyles=function(t){(0,o.renderCSS)(t,e)},e.emit=function(e){(0,l.dispatch)(e)},!e.rendered){e.models={};var n=function(t){var r=e.data[t];if("string"!=typeof r)return"continue";if("@"==r[0]){var n=r.replace("@","");e.data[t]=(0,l.attach)(n,e),e.models[n]=function(r){e.data[t]=r}}};for(var a in e.data){n(a)}e.boot&&e.boot(e)}"function"==typeof e.template?d(e,r,[e.template(e)]):d(e,r,[e.template]),e.styles&&(0,o.renderCSS)(e.styles,e),e.init&&!e.rendered&&(e.rendered=!0,e.init(e)),e.rendered=!0};r.render=f;var d=function(e,t,r){for(var o=0;o<r.length;o++){var l=r[o];if("function"==typeof l&&(l=l(e)),Array.isArray(l)&&(l=(0,a.driveFilters)(e,l)),"string"==typeof l){if((0,u.applySelector)(t.el,l))continue;var f=(0,n.driveDirectives)(l,t,e,r);f&&(o=r.length-1),(0,c.CHECK)(l,"TRANS")&&(l=e.content)}Array.isArray(l)&&(0,i.renderElementArray)(e,t,l)}};r.traverse=d},{"./core":2,"./directives":3,"./exr":6,"./filters":7,"./model":8,"./styles":10,"./utils":11}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={},a=[],o=function(e,t){n[e]||(n[e]=[]),n[e].push(t)},i=function(e){n[e].forEach(function(e){e()})},u={"!":function(e,t,r){var n=e[0].replace("!",""),a=c(e,t),o=r.root.querySelectorAll(t)[0],u=e[1].match(/^\@/);return u?o[n]=function(){i(e[1])}:o[n]=function(){r.setStyles([a])},""},"@":function(e,t,r){var n=(e[0].replace(/^\@/,""),c(e,t));return o(e[0],function(){r.setStyles([n])}),""},">":function(e,t){return e[0]=t+e[0].replace(">",""),a.push(e),""},DEFAULT:function(e,t,r){return f([e],r)}},c=function(e,t){var r=e.slice();return r[0]=t,r},l=function(e){return e.match(/^\*$/)},f=function v(e,t,r){var n="";return e.map(function(e){var a=e[0];r||(n+="."+t.key+" "+a+"{"),e.map(function(e,r){if(0!=r){var o=e[0][0];return Array.isArray(e)?void(l(o)?n+=v([e],t,!0):(u[o]||u.DEFAULT)(e,a,t)):void(n+=e.replace(/\s+/,":")+";")}}),r||(n+="}")}),n},d=function(e,t){var r="";r+=f(e,t),a.length>0&&(r+=f(a,t),a=[]),s(r,t)};r.renderCSS=d;var s=function(e,t){var r="rs-"+t.key+e.length,n=document.getElementById(r);if(!n){var a=document.getElementById("--rendered-styles");n=document.createElement("style"),n.id=r,a.appendChild(n)}n.innerHTML=e}},{}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./exr.js"),a=function(e){for(var t="",r="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM",n=0;e>n;n++)t+=r[Math.floor(Math.random()*(r.length-1)+1)];return t};r.generateKey=a;var o=function(e,t){var r=t.match(/^[a-z,A-Z,-]+/)[0],a=(0,n.REPLACE)(t,"ATTR","");return(0,n.CHECK)(a,"DATA")&&(a=c(e,a)),{value:a,attr:r}};r.getAttribute=o;var i=function(e,t){if("string"!=typeof t)return!1;if((0,n.CHECK)(t,"ID"))e.id=(0,n.REPLACE)(t,"ID","");else{if(!(0,n.CHECK)(t,"CLAS"))return!1;e.className=(0,n.REPLACE)(t,"CLAS"," ")}return!0};r.applySelector=i;var u=function(e){for(var t=e.nodeName,r=e,n=e.parentNode;n;){for(var a in n.children)n.children[a]==r&&(t=n.nodeName+"["+a+"]/"+t);r=n,n=n.parentNode}return t};r.getElementPath=u;var c=function(e,t){if("string"!=typeof t)return t;var r=(0,n.REPLACE)(t,"DATA","");if(r==t)return t;var a=null;if(r.match(/\./)){var o=r.split(/\./);a=e.data[o[0]][o[1]]}else a=e.data[r];return a};r.getDataFromVar=c;var l=function(e){return e[0]};r.getTag=l;var f=function(e,t){var r=e[e.length-1];return"function"==typeof r?r(t):r};r.getContent=f;var d=function(e){return"string"!=typeof e||(0,n.CHECK)(e,"TRANS")?"":e};r.validateContent=d},{"./exr.js":6}]},{},[5])(5)});